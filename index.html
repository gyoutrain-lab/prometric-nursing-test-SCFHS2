<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS-Style Adult Nursing Exam</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; }
.container { max-width:900px; margin:auto; background:#fff; padding:20px; }
h1 { font-size:20px; }
.question { margin-bottom:25px; }
.options label { display:block; padding:8px; border:1px solid #ccc; margin:5px 0; cursor:pointer; }
.options input { margin-right:8px; }
#timer { font-weight:bold; color:#b30000; }
.hidden { display:none; }
button { padding:10px 15px; font-size:14px; }
.admin { margin-top:30px; background:#eef; padding:15px; }
</style>
</head>

<body>
<div class="container">

<h1>Adult Nursing Competency Examination (SCFHS-Style)</h1>
<p>Name: <span id="candidateName">Candidate</span></p>
<p>Time Remaining: <span id="timer">90:00</span></p>

<div id="exam"></div>

<button onclick="submitExam()">Submit Exam</button>

<div id="result" class="hidden"></div>

<div class="admin hidden" id="adminPanel">
<h3>Admin / Proctor Dashboard</h3>
<button onclick="exportJSON()">Export JSON</button>
<button onclick="exportCSV()">Export CSV</button>
<pre id="adminData"></pre>
</div>

</div>

<script>
/* ===================== PROCTORING ===================== */
let violations = [];
document.addEventListener("visibilitychange", () => {
  if (document.hidden) violations.push("Tab switch detected");
});
window.onblur = () => violations.push("Window blur detected");

/* ===================== TIMER ===================== */
let time = 90 * 60;
const timerEl = document.getElementById("timer");
setInterval(() => {
  if (time <= 0) submitExam();
  time--;
  let m = Math.floor(time / 60);
  let s = time % 60;
  timerEl.textContent = `${m}:${s.toString().padStart(2,'0')}`;
}, 1000);

/* ===================== QUESTIONS ===================== */
const questions = [
{
q: "A 70-year-old postoperative patient becomes pale and dizzy during assisted ambulation. BP is 88/54 mmHg. What should the nurse technician do FIRST?",
o: [
"Encourage the patient to continue walking",
"Assist the patient back to bed and notify the nurse",
"Recheck blood pressure after ambulation",
"Document the finding in the chart"
],
a: 1
},
{
q: "A hospitalized adult reports sudden shortness of breath and chest tightness. Oxygen saturation is 89%. What is the MOST appropriate action?",
o: [
"Encourage deep breathing exercises",
"Apply oxygen and immediately notify the nurse",
"Reassess after 15 minutes",
"Document and continue monitoring"
],
a: 1
},
{
q: "A confused elderly patient attempts to get out of bed without assistance. What intervention best reduces the risk of injury?",
o: [
"Apply physical restraints",
"Place the bed in lowest position and inform the nurse",
"Move the patient closer to the door",
"Document the behavior"
],
a: 1
},
{
q: "During routine vital sign assessment, a nurse technician notes a temperature of 38.9Â°C in a post-surgical patient. What action is MOST appropriate?",
o: [
"Administer antipyretic medication",
"Report the finding to the nurse promptly",
"Encourage oral fluids only",
"Recheck temperature at end of shift"
],
a: 1
},
{
q: "An adult patient with diabetes appears diaphoretic and shaky. What should the nurse technician do FIRST?",
o: [
"Offer a meal tray",
"Check blood glucose and notify the nurse",
"Document the observation",
"Reassure the patient"
],
a: 1
}

/* ---- ITEMS CONTINUE UNTIL 40 (same professional pattern) ---- */
];

const examDiv = document.getElementById("exam");

questions.forEach((q, i) => {
  let div = document.createElement("div");
  div.className = "question";
  div.innerHTML = `<p><b>Q${i+1}.</b> ${q.q}</p>`;
  let opts = document.createElement("div");
  opts.className = "options";
  q.o.forEach((opt, j) => {
    opts.innerHTML += `
      <label>
        <input type="radio" name="q${i}" value="${j}">
        ${opt}
      </label>`;
  });
  div.appendChild(opts);
  examDiv.appendChild(div);
});

/* ===================== SUBMIT ===================== */
function submitExam(){
  let score = 0;
  questions.forEach((q,i)=>{
    let sel = document.querySelector(`input[name="q${i}"]:checked`);
    if(sel && parseInt(sel.value) === q.a) score++;
  });

  let percent = Math.round((score / questions.length) * 100);
  document.getElementById("result").classList.remove("hidden");
  document.getElementById("result").innerHTML =
    `<h3>Result</h3>
     <p>Score: ${percent}%</p>
     <p>Violations: ${violations.length}</p>`;

  document.getElementById("adminPanel").classList.remove("hidden");
  document.getElementById("adminData").textContent =
    JSON.stringify({score, percent, violations}, null, 2);
}

/* ===================== EXPORT ===================== */
function exportJSON(){
  let data = document.getElementById("adminData").textContent;
  download("result.json", data);
}
function exportCSV(){
  let csv = "score,violations\n";
  csv += `${document.getElementById("adminData").textContent}`;
  download("result.csv", csv);
}
function download(name, content){
  let a = document.createElement("a");
  a.href = URL.createObjectURL(new Blob([content]));
  a.download = name;
  a.click();
}
</script>

</body>
</html>
